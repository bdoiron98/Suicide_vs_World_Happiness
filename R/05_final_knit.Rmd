---
title: "2015 and 2016 Suicides vs. Happines Rankings"
output:
  html_document:
    df_print: paged
editor_options:
  chunk_output_type: console
---
```{r, include=FALSE}
library(tidyverse)
```

```{r setup, include=FALSE}
#Load csv file and filter out 'Both sexes'
suicide_data <- read_csv(file = '~/Library/Mobile Documents/com~apple~CloudDocs/ISDS_3070/Suicide_vs_World_Happiness/data/final_project_data/data.csv') %>% 
  filter(Sex != 'Both sexes') %>% 
  gather(Year, SuicidePer100000, 3:6)

#Load csv files and load only country and happiness rank
world16_happiness_data <- read_csv(file = '~/Library/Mobile Documents/com~apple~CloudDocs/ISDS_3070/Suicide_vs_World_Happiness/data/final_project_data/world-happiness-report/2016.csv') %>% 
  select(Country, HappinessRank, Region)

world15_happiness_data <- read_csv(file = '~/Library/Mobile Documents/com~apple~CloudDocs/ISDS_3070/Suicide_vs_World_Happiness/data/final_project_data/world-happiness-report/2015.csv') %>%  
  select(Country, HappinessRank, Region)

#adds year columns to world_happiness

world15_happiness_data$Year <- 2015

world16_happiness_data$Year <- 2016

#combines both world_happiness data sets to each other
world_happiness <- bind_rows(world15_happiness_data, world16_happiness_data)

#filters out countries that are not within both sets 
suicide_data_combined <- suicide_data %>% 
  filter(Country %in% world_happiness$Country)

#creates final data set to have 5 columns: country, year, sex, suicidesper100000, happiness rank
combined_data_set <- mutate(suicide_data_combined, Year = as.double(Year)) %>% 
  inner_join(world_happiness) %>% 
  filter(Year >= 2015)

# Calculations

# 2016 Calculations
combined_data_set %>% 
  filter(Sex == 'Male' & Year == '2016') %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Sex == 'Female' & Year == '2016') %>% 
  summarise(mean(SuicidePer100000))

# 2015 Calculations

combined_data_set %>% 
  filter(Sex == 'Male' & Year == '2015') %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Sex == 'Female' & Year == '2015') %>% 
  summarise(mean(SuicidePer100000))

#2016 mean sucicdes per region and sex
combined_data_set %>% 
  filter(Region == "Central and Eastern Europe" & Sex == "Female" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Region == "Central and Eastern Europe" & Sex == "Male" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Region == "Latin America and Caribbean" & Sex == "Female" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Region == "Latin America and Caribbean" & Sex == "Male" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Region == "Middle East and Northern Africa" & Sex == "Female" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Region == "Middle East and Northern Africa" & Sex == "Male" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Region == "Southeastern Asia" & Sex == "Female" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Region == "Southeastern Asia" & Sex == "Male" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Region == "Southern Asia" & Sex == "Female" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Region == "Southern Asia" & Sex == "Male" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Region == "Sub-Saharan Africa" & Sex == "Female" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Region == "Sub-Saharan Africa" & Sex == "Male" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Region == "Western Europe" & Sex == "Female" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Region == "Western Europe" & Sex == "Male" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))
  
combined_data_set %>% 
  filter(Region == "Australia and New Zealand" & Sex == "Female" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))

combined_data_set %>% 
  filter(Region == "Australia and New Zealand" & Sex == "Male" & Year == "2016") %>% 
  summarise(mean(SuicidePer100000))
```

# Question
**Does the World Happiness Report have any correlation to country suicide rates?**

Using two data sets, Suicides Per 100,000 and 2015/2016 World Happiness Report, we will look to see if there is a connection between the "happiest" countries and amount of suicides.

First, let's take a look at the ratio of male to female suicides. 



| Region | Male | Female| Year|
|--------|------|-------|-----|
|Central and Eastern Europe| 19.4 | 4.02 | 2016 |
|Latin America and Caribbean| 14.2 | 3.76 | 2016 |
|Middle East and Northern Africa| 6.25 | 2.44 | 2016 |
|Southeastern Asia| 9.56 | 4.4 | 2016 |
|Southern Asia| 12.3 | 7.07 | 2016 |
|Sub-Saharan Africa| 17 | 7.31 | 2016 |
|Western Europe| 14.4 | 5.05 | 2016 |
|Australia and New Zealand| 17.4 | 6.1 | 2016 |
|North America| 18.1 | 6.1 | 2016


```{r, fg.width= 24, echo= FALSE}
combined_data_set %>% 
  subset(select = -Region) %>% 
  filter(Year == '2016') %>% 
  arrange(HappinessRank) %>% 
  top_n(-50) %>% 
ggplot() +
  geom_col(aes(x = Country, y = SuicidePer100000, fill = Sex ))+
  labs(title = "Top 25 Happiness Rank", subtitle = "2016")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

combined_data_set %>% 
  subset(select = -Region) %>% 
  filter(Year == '2016') %>% 
  arrange(HappinessRank) %>% 
  top_n(50) %>% 
ggplot() +
  geom_col(aes(x = Country, y = SuicidePer100000, fill = Sex ))+
  labs(title = "Bottom 25 Happiness Rank", subtitle = "2016")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
```  

```{r, fig.height= 18, fig.width= 18}
#Female 2015 Happiness Rank vs. Suicides
combined_data_set %>% 
  filter(Sex == 'Female' & Year == '2015') %>% 
  arrange(HappinessRank) %>%
  mutate(RankofHappiness = case_when( HappinessRank >= 1 & HappinessRank <= 52 ~ "Top 52",
                                      HappinessRank >= 53 & HappinessRank <= 106 ~ "Rank 53-106",
                                      HappinessRank >= 106 & HappinessRank <= 157 ~ "Bottom 52")) %>%  
   subset(!is.na(RankofHappiness)) %>% 

  ggplot()+
  geom_col(aes(x = Country, y = SuicidePer100000, fill = RankofHappiness))+
  geom_segment(x = 0, y = 5.32, xend = 157, yend = 5.32, color = 'gold')+
  facet_wrap(RankofHappiness == "Top 52" ~ Region, scales = "free")+
  labs(title = "Happiness Rank vs. Suicides", subtitle = "Females, 2015", x = 'Country', 
                                          y ='Suicides per 100000')+
   theme(axis.text.x = element_blank(),
        axis.title = element_text(face = "bold"))

#Male 2015 Happiness Rank vs. Suicides 
combined_data_set %>% 
  filter(Sex == 'Male' & Year == '2015') %>% 
  arrange(HappinessRank) %>%
  mutate(RankofHappiness = case_when( HappinessRank >= 1 & HappinessRank <= 52 ~ "Top 52",
                                      HappinessRank >= 53 & HappinessRank <= 106 ~ "Rank 53-106",
                                      HappinessRank >= 106 & HappinessRank <= 157 ~ "Bottom 52")) %>% 

  ggplot()+
  geom_col(aes(x = Country, y = SuicidePer100000, fill = RankofHappiness))+
  geom_segment(x = 0, y = 15, xend = 157, yend = 15, color = 'gold')+
  facet_wrap(RankofHappiness ~ Region, scales = "free")+
  labs(title = "Happiness Rank vs. Suicides", subtitle = "Males, 2015", x = 'Country', 
                                          y ='Suicides per 100000')+
   theme(axis.text.x = element_blank(),
        axis.title = element_text(face = "bold"))

```

```{r, fig.height= 18, fig.width= 18}
#Male 2016 Happiness Rank vs. Suicides 
combined_data_set %>% 
  filter(Sex == 'Male' & Year == '2016') %>% 
  arrange(HappinessRank) %>%
  mutate(RankofHappiness = case_when( HappinessRank >= 1 & HappinessRank <= 52 ~ "Top 52",
                                      HappinessRank >= 53 & HappinessRank <= 106 ~ "Rank 53-106",
                                      HappinessRank >= 106 & HappinessRank <= 157 ~ "Bottom 52")) %>% 

  ggplot()+
  geom_col(aes(x = Country, y = SuicidePer100000, fill = RankofHappiness))+
  geom_segment(x = 0, y = 14.7, xend = 157, yend = 14.7, color = 'gold')+
  facet_wrap(RankofHappiness ~ Region, scales = "free")+
  labs(title = "Happiness Rank vs. Suicides", subtitle = "Males, 2016", x = 'Country', 
                                          y ='Suicides per 100000')+
   theme(axis.text.x = element_blank(),
        axis.title = element_text(face = "bold"))

#Female 2016 Happiness Rank vs. Suicides
combined_data_set %>% 
  filter(Sex == 'Female' & Year == '2016') %>% 
  arrange(HappinessRank) %>%
  mutate(RankofHappiness = case_when( HappinessRank >= 1 & HappinessRank <= 52 ~ "Top 52",
                                      HappinessRank >= 53 & HappinessRank <= 106 ~ "Rank 53-106",
                                      HappinessRank >= 106 & HappinessRank <= 157 ~ "Bottom 52")) %>% 

  ggplot()+
  geom_col(aes(x = Country, y = SuicidePer100000, fill = RankofHappiness))+
  geom_segment(x = 0, y = 5.21, xend = 157, yend = 5.21, color = 'gold')+
  facet_wrap(RankofHappiness ~ Region, scales = "free")+
  labs(title = "Happiness Rank vs. Suicides", subtitle = "Females, 2016", x = 'Country', 
                                          y ='Suicides per 100000')+
   theme(axis.text.x = element_blank(),
        axis.title = element_text(face = "bold"))
  


 

```

## Tables for each region in the year 2016
##### Middle Eastern and Nothern Africa
```{r, echo= FALSE}

combined_data_set %>% 
  filter(Year == "2016" & Region == "Middle East and Northern Africa" & Sex == "Male") %>% 
  select(Country, HappinessRank)
```

##### Central and Eastern Europe
```{r, echo= FALSE}
combined_data_set %>% 
  filter(Year == "2016" & Region == "Central and Eastern Europe" & Sex == "Male") %>% 
  select(Country, HappinessRank)
```

##### Latin America and Caribbean
```{r, echo= FALSE}
combined_data_set %>% 
  filter(Year == "2016" & Region == "Latin America and Caribbean" & Sex == "Male") %>% 
  select(Country, HappinessRank)
```

##### Southeastern Asia
```{r, echo= FALSE}
combined_data_set %>% 
  filter(Year == "2016" & Region == "Southeastern Asia" & Sex == "Male") %>% 
  select(Country, HappinessRank)
```

##### Southern Asia
```{r, echo= FALSE}
combined_data_set %>% 
  filter(Year == "2016" & Region == "Southern Asia" & Sex == "Male") %>% 
  select(Country, HappinessRank)
```

##### Sub-Saharan Africa
```{r, echo= FALSE}
combined_data_set %>% 
  filter(Year == "2016" & Region == "Sub-Saharan Africa" & Sex == "Male") %>% 
  select(Country, HappinessRank)
```

##### Western Europe
```{r, echo= FALSE}
combined_data_set %>% 
  filter(Year == "2016" & Region == "Western Europe" & Sex == "Male") %>% 
  select(Country, HappinessRank)
```

##### Australia and New Zealand
```{r, echo= FALSE}
combined_data_set %>% 
  filter(Year == "2016" & Region == "Australia and New Zealand" & Sex == "Male") %>% 
  select(Country, HappinessRank)
```

##### North America
```{r, echo= FALSE}
combined_data_set %>% 
  filter(Year == "2016" & Region == "North America" & Sex == "Male") %>% 
  select(Country, HappinessRank)
```